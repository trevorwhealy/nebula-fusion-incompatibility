import React from 'react';
import { createPlugin, dangerouslySetHTML } from 'fusion-core';
import reactHelmetAsync, { HelmetProvider } from 'react-helmet-async';
export { default as Helmet } from 'react-helmet-async';

/** Copyright (c) 2018 Uber Technologies, Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 *
 * 
 */
const keys = ['meta', 'link', 'style', 'base', 'noscript', 'script'];
const plugin = true && createPlugin({
  middleware: () => {
    return async (ctx, next) => {
      if (!ctx.element) {
        return next();
      }

      const helmetContext = {};
      ctx.element = React.createElement(HelmetProvider, {
        context: helmetContext
      }, ctx.element);
      await next();
      const {
        helmet
      } = helmetContext;

      if (helmet) {
        ctx.template.title = helmet.title.toString().replace('</title>', '').replace(/^<title.*>/, '');
        keys.forEach(key => {
          ctx.template.head.push(dangerouslySetHTML(helmet[key].toString()));
        });
      }
    };
  }
});

/** Copyright (c) 2018 Uber Technologies, Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 *
 * 
 */

/** Copyright (c) 2018 Uber Technologies, Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 *
 * 
 */
var index = plugin;

export default index;
//# sourceMappingURL=index.es.js.map
