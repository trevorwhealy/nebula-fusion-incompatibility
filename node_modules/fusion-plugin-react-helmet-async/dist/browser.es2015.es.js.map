{"version":3,"file":"browser.es2015.es.js","sources":["../src/server.js","../src/browser.js","../src/index.js"],"sourcesContent":["/** Copyright (c) 2018 Uber Technologies, Inc.\n *\n * This source code is licensed under the MIT license found in the\n * LICENSE file in the root directory of this source tree.\n *\n * @flow\n */\n\nimport React from 'react';\nimport {createPlugin, dangerouslySetHTML} from 'fusion-core';\nimport {HelmetProvider} from 'react-helmet-async';\n\nimport type {FusionPlugin} from 'fusion-core';\n\nconst keys = ['meta', 'link', 'style', 'base', 'noscript', 'script'];\n\nconst plugin =\n  __NODE__ &&\n  createPlugin({\n    middleware: () => {\n      return async (ctx, next) => {\n        if (!ctx.element) {\n          return next();\n        }\n        const helmetContext = {};\n        ctx.element = (\n          <HelmetProvider context={helmetContext}>{ctx.element}</HelmetProvider>\n        );\n        await next();\n        const {helmet} = helmetContext;\n        if (helmet) {\n          ctx.template.title = helmet.title\n            .toString()\n            .replace('</title>', '')\n            .replace(/^<title.*>/, '');\n          keys.forEach(key => {\n            ctx.template.head.push(dangerouslySetHTML(helmet[key].toString()));\n          });\n        }\n      };\n    },\n  });\n\nexport default ((plugin: any): FusionPlugin<void, void>);\n","/** Copyright (c) 2018 Uber Technologies, Inc.\n *\n * This source code is licensed under the MIT license found in the\n * LICENSE file in the root directory of this source tree.\n *\n * @flow\n */\n\nimport React from 'react';\nimport {createPlugin} from 'fusion-core';\nimport {HelmetProvider} from 'react-helmet-async';\n\nimport type {FusionPlugin} from 'fusion-core';\n\nconst plugin =\n  __BROWSER__ &&\n  createPlugin({\n    middleware: () => {\n      return (ctx, next) => {\n        ctx.element = (\n          <HelmetProvider context={{}}>{ctx.element}</HelmetProvider>\n        );\n        return next();\n      };\n    },\n  });\n\nexport default ((plugin: any): FusionPlugin<void, void>);\n","/** Copyright (c) 2018 Uber Technologies, Inc.\n *\n * This source code is licensed under the MIT license found in the\n * LICENSE file in the root directory of this source tree.\n *\n * @flow\n */\n\nimport Helmet from 'react-helmet-async';\nimport serverPlugin from './server';\nimport clientPlugin from './browser';\n\ndeclare var __NODE__: Boolean;\nexport default (__NODE__ ? serverPlugin : clientPlugin);\nexport {Helmet};\n"],"names":["plugin","createPlugin","ctx","next","element","clientPlugin"],"mappings":";;;;;AAAA;;;;;;;;ACAA;;;;;;;AAQA,AAMA,MAAMA,WACJ,QACAC,aAAa;cACC,MAAM;WACT,CAACC,GAAD,EAAMC,IAAN,KAAe;UAChBC,OAAJ,GACE,oBAAC,cAAD;iBAAyB;SAAKF,IAAIE,OAAlC,CADF;aAGOD,MAAP;KAJF;;CAFJ,CAFF;;ACdA;;;;;;;AAQA,AAKA,YAA0CE,QAA1C;;;;"}