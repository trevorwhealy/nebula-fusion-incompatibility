{"version":3,"sources":["../../../src/wip/track-context-creation.js"],"names":["trackContextCreation","onContextCreate","onContextCreated","HTMLCanvasElement","getContext","prototype","getContextSpy","type","opts","context","canvas","bind","call","WebGLRenderingContext"],"mappings":";;;;;;;AACA;;;;;;AACA;;AAEA;;;;AAIO,SAASA,oBAAT,OAGJ;AAAA,kCAFDC,eAEC;AAAA,MAFDA,eAEC,qCAFiB;AAAA,WAAM,IAAN;AAAA,GAEjB;AAAA,mCADDC,gBACC;AAAA,MADDA,gBACC,sCADkB,YAAM,CAAE,CAC1B;AACD,uBAAOD,mBAAmBC,gBAA1B;;AACA,MAAI,OAAOC,iBAAP,KAA6B,WAAjC,EAA8C;AAC5C,QAAMC,aAAaD,kBAAkBE,SAAlB,CAA4BD,UAA/C;;AACAD,sBAAkBE,SAAlB,CAA4BD,UAA5B,GAAyC,SAASE,aAAT,CAAuBC,IAAvB,EAA6BC,IAA7B,EAAmC;AAC1E;AACA,UAAIC,OAAJ;;AACA,UAAIF,SAAS,OAAb,EAAsB;AACpBE,kBAAUR,gBAAgB;AAACS,kBAAQ,IAAT;AAAeH,oBAAf;AAAqBC,oBAArB;AAA2BJ,sBAAYA,WAAWO,IAAX,CAAgB,IAAhB;AAAvC,SAAhB,CAAV;AACD,OALyE,CAM1E;;;AACAF,gBAAUA,WAAWL,WAAWQ,IAAX,CAAgB,IAAhB,EAAsBL,IAAtB,EAA4BC,IAA5B,CAArB,CAP0E,CAQ1E;;AACA,sBAAIC,OAAJ,EAAuBI,qBAAvB,GAA8C;AAC5CX,yBAAiB;AAACQ,kBAAQ,IAAT;AAAeD,0BAAf;AAAwBF,oBAAxB;AAA8BC;AAA9B,SAAjB;AACD;;AACD,aAAOC,OAAP;AACD,KAbD;AAcD;AACF","sourcesContent":["// Create a WebGL context\nimport assert from '../utils/assert';\n/* global HTMLCanvasElement, WebGLRenderingContext */\n\n/**\n * Installs a spy on Canvas.getContext\n * calls the provided callback with the {context}\n */\nexport function trackContextCreation({\n  onContextCreate = () => null,\n  onContextCreated = () => {}\n}) {\n  assert(onContextCreate || onContextCreated);\n  if (typeof HTMLCanvasElement !== 'undefined') {\n    const getContext = HTMLCanvasElement.prototype.getContext;\n    HTMLCanvasElement.prototype.getContext = function getContextSpy(type, opts) {\n      // Let intercepter create context\n      let context;\n      if (type === 'webgl') {\n        context = onContextCreate({canvas: this, type, opts, getContext: getContext.bind(this)});\n      }\n      // If not, create context\n      context = context || getContext.call(this, type, opts);\n      // Report it created\n      if (context instanceof WebGLRenderingContext) {\n        onContextCreated({canvas: this, context, type, opts});\n      }\n      return context;\n    };\n  }\n}\n"],"file":"track-context-creation.js"}