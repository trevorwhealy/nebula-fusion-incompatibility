{"version":3,"sources":["../../../src/wip/track-context-creation.js"],"names":["assert","trackContextCreation","onContextCreate","onContextCreated","HTMLCanvasElement","getContext","prototype","getContextSpy","type","opts","context","canvas","bind","call","WebGLRenderingContext"],"mappings":"AAAA;AACA,OAAOA,MAAP,MAAmB,iBAAnB;AACA;;AAEA;;;;;AAIA,OAAO,SAASC,oBAAT,CAA8B;AACnCC,oBAAkB,MAAM,IADW;AAEnCC,qBAAmB,MAAM,CAAE;AAFQ,CAA9B,EAGJ;AACDH,SAAOE,mBAAmBC,gBAA1B;;AACA,MAAI,OAAOC,iBAAP,KAA6B,WAAjC,EAA8C;AAC5C,UAAMC,aAAaD,kBAAkBE,SAAlB,CAA4BD,UAA/C;;AACAD,sBAAkBE,SAAlB,CAA4BD,UAA5B,GAAyC,SAASE,aAAT,CAAuBC,IAAvB,EAA6BC,IAA7B,EAAmC;AAC1E;AACA,UAAIC,OAAJ;;AACA,UAAIF,SAAS,OAAb,EAAsB;AACpBE,kBAAUR,gBAAgB;AAACS,kBAAQ,IAAT;AAAeH,cAAf;AAAqBC,cAArB;AAA2BJ,sBAAYA,WAAWO,IAAX,CAAgB,IAAhB;AAAvC,SAAhB,CAAV;AACD,OALyE,CAM1E;;;AACAF,gBAAUA,WAAWL,WAAWQ,IAAX,CAAgB,IAAhB,EAAsBL,IAAtB,EAA4BC,IAA5B,CAArB,CAP0E,CAQ1E;;AACA,UAAIC,mBAAmBI,qBAAvB,EAA8C;AAC5CX,yBAAiB;AAACQ,kBAAQ,IAAT;AAAeD,iBAAf;AAAwBF,cAAxB;AAA8BC;AAA9B,SAAjB;AACD;;AACD,aAAOC,OAAP;AACD,KAbD;AAcD;AACF","sourcesContent":["// Create a WebGL context\nimport assert from '../utils/assert';\n/* global HTMLCanvasElement, WebGLRenderingContext */\n\n/**\n * Installs a spy on Canvas.getContext\n * calls the provided callback with the {context}\n */\nexport function trackContextCreation({\n  onContextCreate = () => null,\n  onContextCreated = () => {}\n}) {\n  assert(onContextCreate || onContextCreated);\n  if (typeof HTMLCanvasElement !== 'undefined') {\n    const getContext = HTMLCanvasElement.prototype.getContext;\n    HTMLCanvasElement.prototype.getContext = function getContextSpy(type, opts) {\n      // Let intercepter create context\n      let context;\n      if (type === 'webgl') {\n        context = onContextCreate({canvas: this, type, opts, getContext: getContext.bind(this)});\n      }\n      // If not, create context\n      context = context || getContext.call(this, type, opts);\n      // Report it created\n      if (context instanceof WebGLRenderingContext) {\n        onContextCreated({canvas: this, context, type, opts});\n      }\n      return context;\n    };\n  }\n}\n"],"file":"track-context-creation.js"}